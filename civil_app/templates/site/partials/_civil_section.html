<!-- ================= CIVIL ================= -->
<h3 onclick="toggleSection(this)" class="section-title-modern">
  <span class="flex items-center gap-2">
    ðŸ‘· <span>Civil Teams</span>
  </span>
  <span class="section-arrow-modern">â–¾</span>
</h3>

<div class="table-card-modern civil-wrapper">

  <!-- ===== HEADER ===== -->
  <div class="table-head-modern"
       style="grid-template-columns:
       minmax(160px,1.4fr)
       repeat(4,minmax(50px,.6fr))
       minmax(70px,.7fr)
       minmax(70px,.7fr)
       minmax(80px,.8fr)
       minmax(90px,.9fr)
       minmax(90px,.9fr);">

    <div>Team</div>
    <div class="text-center">M F</div>
    <div class="text-center">H F</div>
    <div class="text-center">M H</div>
    <div class="text-center">H H</div>
    <div class="text-center">Mason â‚¹</div>
    <div class="text-center">Helper â‚¹</div>
    <div class="text-center">Advance</div>
    <div class="text-center">Labour</div>
    <div class="text-center">Total</div>
  </div>

  <!-- ===== BODY ===== -->
  <div class="table-body-modern">

    {% for row in civil_rows %}
    <div class="table-row-modern"
         style="grid-template-columns:
         minmax(160px,1.4fr)
         repeat(4,minmax(50px,.6fr))
         minmax(70px,.7fr)
         minmax(70px,.7fr)
         minmax(80px,.8fr)
         minmax(90px,.9fr)
         minmax(90px,.9fr);">

      <!-- Team -->
      <div class="font-semibold truncate">
        {{ row.team.name }}
      </div>

      <!-- Mason Full -->
      <input name="mason_full_{{ row.team.id }}"
             value="{{ row.work.mason_full|default:0 }}"
             class="table-input-modern money"
             oninput="calcCivil({{ row.team.id }}, {{ row.rate.mason_full_rate }}, {{ row.rate.helper_full_rate }})">

      <!-- Helper Full -->
      <input name="helper_full_{{ row.team.id }}"
             value="{{ row.work.helper_full|default:0 }}"
             class="table-input-modern money"
             oninput="calcCivil({{ row.team.id }}, {{ row.rate.mason_full_rate }}, {{ row.rate.helper_full_rate }})">

      <!-- Mason Half -->
      <input name="mason_half_{{ row.team.id }}"
             value="{{ row.work.mason_half|default:0 }}"
             class="table-input-modern money"
             oninput="calcCivil({{ row.team.id }}, {{ row.rate.mason_full_rate }}, {{ row.rate.helper_full_rate }})">

      <!-- Helper Half -->
      <input name="helper_half_{{ row.team.id }}"
             value="{{ row.work.helper_half|default:0 }}"
             class="table-input-modern money"
             oninput="calcCivil({{ row.team.id }}, {{ row.rate.mason_full_rate }}, {{ row.rate.helper_full_rate }})">

      <!-- Rates -->
      <div class="table-box-modern">â‚¹{{ row.rate.mason_full_rate }}</div>
      <div class="table-box-modern">â‚¹{{ row.rate.helper_full_rate }}</div>

      <!-- Advance -->
      <input name="advance_{{ row.team.id }}"
             value="{{ row.advance }}"
             class="table-input-modern money advance-modern"
             oninput="calcCivil({{ row.team.id }}, {{ row.rate.mason_full_rate }}, {{ row.rate.helper_full_rate }})">

      <!-- Labour -->
      <div id="civil_labour_{{ row.team.id }}"
           class="table-box-modern labour-modern">
        {{ row.labour }}
      </div>

      <!-- Total -->
      <div id="civil_total_{{ row.team.id }}"
           class="table-box-modern total-modern">
        {{ row.total }}
      </div>

    </div>
    {% endfor %}

  </div>
</div>
<style>
  /* ===== SECTION HEADER ===== */
.section-title-modern{
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 18px;
  border-radius:14px;
  border:1px solid #e2e8f0;
  background:linear-gradient(180deg,#ffffff,#f8fafc);
  font-weight:800;
  color:#0f172a;
  transition:.2s ease;
  margin-top:18px;
}

.section-title-modern:hover{
  background:#f8fafc;
}

.section-arrow-modern{
  color:#94a3b8;
  transition:transform .25s ease;
}

/* ===== CARD ===== */
.table-card-modern{
  width:100%;
  background:#ffffff;
  border:1px solid #e5e7eb;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,.05);
}

/* ===== HEADER ===== */
.table-head-modern{
  display:grid;
  background:#f8fafc;
  padding:10px 14px;
  font-size:.72rem;
  font-weight:800;
  color:#475569;
  border-bottom:1px solid #e5e7eb;
}

/* ===== BODY ===== */
.table-body-modern{
  max-height:420px;
  overflow-y:auto;
}

/* ===== ROW ===== */
.table-row-modern{
  display:grid;
  align-items:center;
  gap:8px;
  padding:8px 14px;
  border-bottom:1px solid #f1f5f9;
  background:#ffffff;
  transition:.12s ease;
}

.table-row-modern:nth-child(even){
  background:#fafafa;
}

.table-row-modern:hover{
  background:#f8fafc;
}

/* ===== INPUT ===== */
.table-input-modern{
  width:100%;
  height:30px;
  border:1px solid #d1d5db;
  border-radius:6px;
  padding:2px 6px;
  font-size:.82rem;
  font-weight:700;
  background:white;
}

.table-input-modern:focus{
  outline:none;
  border-color:#facc15;
  box-shadow:0 0 0 2px rgba(250,204,21,.18);
}

/* ===== BOX ===== */
.table-box-modern{
  height:30px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#f1f5f9;
  border-radius:6px;
  font-weight:800;
  font-size:.82rem;
}

/* ===== COLORS ===== */
.money{ text-align:right; }

.labour-modern{
  background:#fef3c7;
  color:#92400e;
}

.total-modern{
  background:#dcfce7;
  color:#166534;
}

.advance-modern{
  background:#fff7ed;
}

/* ===== MOBILE ===== */
@media (max-width:640px){

  .table-row-modern{
    gap:6px;
    padding:7px 10px;
  }

  .table-box-modern{
    font-size:.75rem;
  }

}
</style>
<script>
function toggleSection(el){
  const card = el.nextElementSibling;
  const arrow = el.querySelector(".section-arrow-modern");

  if (!card) return;

  card.classList.toggle("hidden");

  if (arrow){
    arrow.style.transform =
      card.classList.contains("hidden")
        ? "rotate(-90deg)"
        : "rotate(0deg)";
  }
}
</script>