<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">

<style>
/* ================= PAGE ================= */
@page {
  size: A4;
  margin: 14mm 12mm 16mm 12mm;

  @bottom-right {
    content: "Page " counter(page) " of " counter(pages);
    font-size: 8px;
    color: #6b7280;
  }
}

/* ================= BASE ================= */
body{
  font-family: DejaVu Sans, Arial, sans-serif;
  font-size: 10px;
  color:#0f172a;
}

/* ================= CONTAINER ================= */
.page{
  border:1px solid #e5e7eb;
  padding:16px;
  border-radius:6px;
}

/* ================= HEADER ================= */
.header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  border-bottom:3px solid #111827;
  padding-bottom:10px;
  margin-bottom:12px;
}

.brand{
  font-size:20px;
  font-weight:900;
  color:#111827;
  letter-spacing:.4px;
}

.subtitle{
  font-size:9px;
  color:#6b7280;
  margin-top:2px;
}

.report-box{
  text-align:right;
}

.report-title{
  font-size:14px;
  font-weight:900;
  color:#111827;
}

.report-date{
  font-size:9px;
  color:#6b7280;
}

/* ================= META ================= */
.meta{
  margin-top:8px;
  padding:7px 10px;
  background:#f8fafc;
  border:1px solid #e5e7eb;
  font-size:9.5px;
  border-radius:4px;
}

/* ================= SUMMARY ================= */
.summary{
  margin-top:12px;
  border:1px solid #fde68a;
  background:linear-gradient(180deg,#fff7ed,#ffffff);
  padding:8px 10px;
  font-size:10px;
  border-radius:4px;
}

.summary strong{
  color:#111827;
}

.summary .grand{
  color:#065f46;
  font-weight:900;
}

/* ================= TABLE ================= */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:14px;
}

/* header */
thead th{
  background:#111827;
  color:#ffffff;
  font-weight:800;
  font-size:9px;
  text-transform:uppercase;
  letter-spacing:.5px;
  padding:7px 5px;
  border:1px solid #000;
}

/* body */
tbody td{
  border:1px solid #d1d5db;
  padding:6px 5px;
  vertical-align:middle;
}

tbody tr:nth-child(even){
  background:#f9fafb;
}

/* hover feel (safe for pdf) */
tbody tr{
  transition:all .15s ease;
}

/* ================= ALIGN ================= */
.center{ text-align:center; }
.right{ text-align:right; }

/* ================= MONEY ================= */
.money{
  font-weight:700;
}

/* ================= TOTAL ROW ================= */
.total-row td{
  font-weight:900;
  background:#fef3c7;
  border-top:2px solid #111827;
  font-size:10.5px;
}

.grand{
  color:#065f46;
  font-size:11px;
  font-weight:900;
}

/* ================= FOOTER ================= */
.footer{
  margin-top:16px;
  font-size:8.5px;
  color:#6b7280;
  display:flex;
  justify-content:space-between;
  border-top:1px solid #e5e7eb;
  padding-top:6px;
}

/* ================= HELPERS ================= */
.site{ font-weight:700; }
.dept{ color:#374151; }

</style>
</head>

<body>

<div class="page">

<!-- ================= HEADER ================= -->
<div class="header">

  <div>
    <div class="brand">üèó SK BUILDERS</div>
    <div class="subtitle">Civil Management System</div>
  </div>

  <div class="report-box">
    <div class="report-title">PROJECT EXPENSE REPORT</div>
    <div class="report-date">
      {{ from_date|date:"d M Y" }} ‚Äî {{ to_date|date:"d M Y" }}
    </div>
  </div>

</div>

<!-- ================= SUMMARY ================= -->
<div class="summary">
  <strong>Labour:</strong> ‚Çπ{{ total_labour }}
  &nbsp;&nbsp;|&nbsp;&nbsp;
  <strong>Material:</strong> ‚Çπ{{ total_material }}
  &nbsp;&nbsp;|&nbsp;&nbsp;
  <strong>Advance:</strong> ‚Çπ{{ total_advance }}
  &nbsp;&nbsp;|&nbsp;&nbsp;
  <strong class="grand">Grand Total: ‚Çπ{{ grand_total }}</strong>
</div>

<!-- ================= TABLE ================= -->
<table>
  <thead>
    <tr>
      <th style="width:10%">Date</th>
      <th style="width:16%">Site</th>
      <th style="width:16%">Department</th>
      <th style="width:16%">Team / Party</th>
      <th style="width:10%">Labour</th>
      <th style="width:10%">Material</th>
      <th style="width:10%">Advance</th>
      <th style="width:12%">Total</th>
    </tr>
  </thead>

  <tbody>
    {% for r in rows %}
    <tr>
      <td class="center">{{ r.date|date:"d-m-Y" }}</td>
      <td class="site">{{ r.site }}</td>
      <td class="dept">{{ r.department }}</td>
      <td>{{ r.team }}</td>
      <td class="right money">‚Çπ{{ r.labour }}</td>
      <td class="right money">‚Çπ{{ r.material }}</td>
      <td class="right money">‚Çπ{{ r.advance }}</td>
      <td class="right money"><strong>‚Çπ{{ r.total }}</strong></td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="8" class="center" style="padding:20px;color:#9ca3af;">
        No records found for selected period
      </td>
    </tr>
    {% endfor %}

    <!-- TOTAL -->
    <tr class="total-row">
      <td colspan="4">TOTAL</td>
      <td class="right">‚Çπ{{ total_labour }}</td>
      <td class="right">‚Çπ{{ total_material }}</td>
      <td class="right">‚Çπ{{ total_advance }}</td>
      <td class="right grand">‚Çπ{{ grand_total }}</td>
    </tr>
  </tbody>
</table>

<!-- ================= FOOTER ================= -->
<div class="footer">
  <div>Confidential Financial Report</div>
  <div>Generated on {{ now|date:"d-m-Y H:i" }}</div>
</div>

</div>
</body>
</html>