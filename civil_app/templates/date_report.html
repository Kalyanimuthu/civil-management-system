{% extends 'base.html' %}
{% block content %}

<h2 class="text-xl font-bold mb-4 text-slate-800">
  üìä Date-wise Report
</h2>

<!-- FILTER CARD -->
<div class="bg-white shadow rounded-xl p-4 mb-6">
  <form method="get" class="flex flex-col sm:flex-row gap-3 items-end">

    <div class="flex flex-col">
      <label class="text-sm font-semibold text-gray-600">From Date</label>
      <input type="date" name="from"
             value="{{ from|date:'Y-m-d' }}"
             class="border p-2 rounded">
    </div>

    <div class="flex flex-col">
      <label class="text-sm font-semibold text-gray-600">To Date</label>
      <input type="date" name="to"
             value="{{ to|date:'Y-m-d' }}"
             class="border p-2 rounded">
    </div>

    <button type="submit"
            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded font-semibold">
      üîç Filter
    </button>

  </form>
</div>

<!-- SUMMARY TOTALS -->
<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">

  <div class="bg-white rounded-xl shadow p-4">
    <p class="text-sm text-gray-500">Total Labour</p>
    <p class="text-xl font-bold text-orange-600">
      ‚Çπ{{ total_labour }}
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-4">
    <p class="text-sm text-gray-500">Total Material</p>
    <p class="text-xl font-bold text-blue-600">
      ‚Çπ{{ total_material }}
    </p>
  </div>

  <div class="bg-white rounded-xl shadow p-4">
    <p class="text-sm text-gray-500">Grand Total</p>
    <p class="text-xl font-bold text-green-600">
      ‚Çπ{{ grand_total }}
    </p>
  </div>

</div>


<!-- REPORT TABLE -->
<div class="bg-white shadow rounded-xl overflow-x-auto">
  <table class="w-full text-sm">
    <thead class="bg-slate-800 text-white">
      <tr>
        <th class="p-3 text-left">Date</th>
        <th class="p-3 text-left">Site</th>
        <th class="p-3 text-left">Department</th>
        <th class="p-3 text-left">Team</th>
        <th class="p-3 text-right">Labour ‚Çπ</th>
        <th class="p-3 text-right">Material ‚Çπ</th>
        <th class="p-3 text-right">Total ‚Çπ</th>
      </tr>
    </thead>

    <tbody class="divide-y">

      <!-- CIVIL ENTRIES -->
      {% for r in civil_entries %}
      <tr class="hover:bg-gray-50">
        <td class="p-2">{{ r.date }}</td>
        <td class="p-2">{{ r.site.name }}</td>
        <td class="p-2">Civil</td>
        <td class="p-2">{{ r.team.name }}</td>
        <td class="p-2 text-right">‚Çπ{{ r.labour_amount }}</td>
        <td class="p-2 text-right">‚Çπ{{ r.material_amount }}</td>
        <td class="p-2 text-right font-semibold">
          ‚Çπ{{ r.labour_amount|add:r.material_amount }}
        </td>
      </tr>
      {% endfor %}

      <!-- OTHER DEPARTMENTS -->
      {% for r in dept_entries %}
      <tr class="hover:bg-gray-50">
        <td class="p-2">{{ r.date }}</td>
        <td class="p-2">{{ r.site.name }}</td>
        <td class="p-2">{{ r.department.name }}</td>
        <td class="p-2">‚Äî</td>
        <td class="p-2 text-right">‚Çπ{{ r.labour_amount }}</td>
        <td class="p-2 text-right">‚Çπ{{ r.material_amount }}</td>
        <td class="p-2 text-right font-semibold">
          ‚Çπ{{ r.labour_amount|add:r.material_amount }}
        </td>
      </tr>
      {% endfor %}

      {% if not civil_entries and not dept_entries %}
      <tr>
        <td colspan="7" class="p-6 text-center text-gray-500">
          No data available for selected date range
        </td>
      </tr>
      {% endif %}

    </tbody>
  </table>
</div>

{% endblock %}
